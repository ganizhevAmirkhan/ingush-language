<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ò–Ω–≥—É—à—Å–∫–æ‚Äì–†—É—Å—Å–∫–∏–π –°–ª–æ–≤–∞—Ä—å</title>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: var(--bg);
    color: var(--fg);
}
:root {
    --bg: #ffffff;
    --fg: #000000;
    --card: #f4f4f4;
}
.dark {
    --bg: #1c1c1c;
    --fg: #f0f0f0;
    --card: #333;
}
.container {
    max-width: 900px;
    margin: auto;
    padding: 20px;
}
input {
    width: 100%;
    padding: 14px;
    font-size: 18px;
}
button {
    font-size: 16px;
    padding: 10px 20px;
}
.item {
    background: var(--card);
    padding: 15px;
    margin-top: 10px;
    border-radius: 6px;
}
.highlight {
    background: yellow;
    font-weight: bold;
}
#suggestions {
    background: var(--card);
    border-radius: 6px;
    margin-top: 5px;
}
.sug-item {
    padding: 8px;
    cursor: pointer;
}
.sug-item:hover {
    background: #ddd;
}
.switches {
    margin: 10px 0;
}
.switches button {
    margin-right: 10px;
}
.tts-btn {
    cursor: pointer;
    margin-left: 10px;
}
</style>
</head>
<body class="light">

<div class="container">

<h1>–ò–Ω–≥—É—à—Å–∫–æ‚Äì–†—É—Å—Å–∫–∏–π –°–ª–æ–≤–∞—Ä—å</h1>

<div class="switches">
    <button onclick="setMode('auto')">–ê–≤—Ç–æ</button>
    <button onclick="setMode('ru2ing')">Ru ‚Üí Ing</button>
    <button onclick="setMode('ing2ru')">Ing ‚Üí Ru</button>
    <button onclick="toggleTheme()">üåô/‚òÄÔ∏è</button>
</div>

<input id="query" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ..." oninput="autocomplete()" />

<div id="suggestions"></div>

<button onclick="search()">–ü–æ–∏—Å–∫</button>

<div id="result"></div>

</div>

<script>
let MODE = "auto";
let DICT = [];

async function loadDict() {
    const resp = await fetch("https://ganizhevamirkhan.github.io/ingush-language/NEW_ingush_dictionary.json");
    DICT = await resp.json();
}
loadDict();

function setMode(m) { MODE = m; }

function toggleTheme() {
    document.body.classList.toggle("dark");
}

function highlight(text, query) {
    const i = text.toLowerCase().indexOf(query.toLowerCase());
    if (i < 0) return text;
    return text.substring(0, i)
        + "<span class='highlight'>" + text.substring(i, i+query.length) + "</span>"
        + text.substring(i+query.length);
}

// --------------------- AUTOCOMPLETE ---------------------

function autocomplete() {
    const q = document.getElementById("query").value.trim();
    if (!q) {
        document.getElementById("suggestions").innerHTML = "";
        return;
    }

    const results = DICT.filter(e =>
        e.russian.startsWith(q) ||
        e.ingush.startsWith(q)
    ).slice(0, 10);

    let html = "";
    results.forEach(e => {
        html += `<div class="sug-item" onclick="useSuggestion('${e.russian}')">
                    ${highlight(e.russian, q)} ‚Äî ${highlight(e.ingush, q)}
                 </div>`;
    });

    document.getElementById("suggestions").innerHTML = html;
}

function useSuggestion(word) {
    document.getElementById("query").value = word;
    document.getElementById("suggestions").innerHTML = "";
    search();
}

// --------------------- SEARCH ---------------------

function search() {
    const q = document.getElementById("query").value.trim();
    if (!q) return;

    let results = [];

    if (MODE === "ru2ing") {
        results = DICT.filter(e => e.russian.startsWith(q));
    } else if (MODE === "ing2ru") {
        results = DICT.filter(e => e.ingush.startsWith(q));
    } else {
        // AUTO
        results = DICT.filter(e =>
            e.russian.startsWith(q) ||
            e.ingush.startsWith(q)
        );
    }

    let html = "";
    results.forEach(e => {
        html += `
        <div class="item">
            <b>${highlight(e.russian, q)}</b>
            <span class="tts-btn" onclick="speakRu('${e.russian}')">üó£</span>
            <br>
            ${highlight(e.ingush, q)}
            <span class="tts-btn" onclick="speakIng('${e.ingush}')">üéß</span>
            <br>
            <small>${e.definition || "‚Äî –Ω–µ—Ç —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è ‚Äî"}</small>
        </div>`;
    });

    document.getElementById("result").innerHTML = html;
}

// --------------------- TTS ---------------------

function speakRu(text) {
    var u = new SpeechSynthesisUtterance(text);
    u.lang = "ru-RU";
    speechSynthesis.speak(u);
}

function speakIng(word) {
    const audio = new Audio(`https://ganizhevamirkhan.github.io/ingush-language/audio/${word}.mp3`);
    audio.play();
}
</script>

</body>
</html>
