<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>–ò–Ω–≥—É—à—Å–∫–∏–π —Å–ª–æ–≤–∞—Ä—å v2</title>

<style>
/* ===== iPhone first ===== */
body {
  margin: 0;
  font-family: system-ui, -apple-system, sans-serif;
  background: #f5f5f5;
  color: #111;
}

header {
  position: sticky;
  top: 0;
  background: #111;
  color: #fff;
  padding: 12px;
  font-size: 18px;
  font-weight: 700;
}

#list {
  padding: 10px;
}

.word {
  background: #fff;
  border-radius: 12px;
  padding: 12px;
  margin-bottom: 10px;
}

.word h3 {
  margin: 0 0 6px;
}

.word small {
  color: #666;
}

button {
  font-size: 16px;
  padding: 10px 14px;
  border-radius: 10px;
  border: 0;
  cursor: pointer;
}

.btn {
  background: #e6e6e6;
}

.btn-primary {
  background: #1f6feb;
  color: #fff;
}

.btn-ai {
  background: #111;
  color: #fff;
}

.actions {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-top: 8px;
}

/* ===== FULLSCREEN MODAL ===== */
.modal {
  position: fixed;
  inset: 0;
  background: #fff;
  z-index: 9999;
  display: none;
  flex-direction: column;
}

.modal.show {
  display: flex;
}

.modal header {
  background: #111;
  color: #fff;
}

.modal-content {
  padding: 12px;
  overflow-y: auto;
  flex: 1;
}

label {
  display: block;
  margin-bottom: 14px;
}

label span {
  display: block;
  font-weight: 600;
  margin-bottom: 4px;
}

input, textarea, select {
  width: 100%;
  font-size: 16px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

textarea {
  min-height: 60px;
}

.example {
  border: 1px dashed #ccc;
  border-radius: 10px;
  padding: 10px;
  margin-bottom: 10px;
}

.big {
  font-size: 18px;
  padding: 14px;
}
</style>
</head>

<body>

<header>–ò–Ω–≥—É—à—Å–∫–∏–π —Å–ª–æ–≤–∞—Ä—å</header>

<div id="list"></div>

<!-- ===== MODAL EDITOR ===== -->
<div id="editor" class="modal">
  <header>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞</header>

  <div class="modal-content">

    <label>
      <span>–†—É—Å—Å–∫–∏–π</span>
      <textarea id="ru"></textarea>
      <button class="btn-ai" onclick="aiFixRu()">ü§ñ –£–ª—É—á—à–∏—Ç—å RU</button>
    </label>

    <label>
      <span>–ß–∞—Å—Ç—å —Ä–µ—á–∏</span>
      <select id="pos">
        <option value="">‚Äî</option>
        <option>—Å—É—â.</option>
        <option>–≥–ª.</option>
        <option>–ø—Ä–∏–ª.</option>
        <option>–Ω–∞—Ä–µ—á.</option>
        <option>—Å–æ—é–∑</option>
      </select>
    </label>

    <label>
      <span>–ò–Ω–≥—É—à—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã</span>
      <textarea id="ing"></textarea>
      <button class="btn-ai" onclick="aiTranslateIng()">ü§ñ –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ ING</button>
    </label>

    <h3>–ü—Ä–∏–º–µ—Ä—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</h3>
    <div id="examples"></div>
    <button class="btn" onclick="addExample()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä</button>
    <button class="btn-ai" onclick="aiGenerateExample()">ü§ñ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä</button>

    <h3>–ê—É–¥–∏–æ</h3>
    <button class="btn">üé§ –ó–∞–ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–æ</button>
    <button class="btn">üé§ –ó–∞–ø–∏—Å–∞—Ç—å –ø—Ä–∏–º–µ—Ä</button>

    <div class="actions">
      <button class="btn-primary big" onclick="saveWord()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button class="btn big" onclick="closeEditor()">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

  </div>
</div>

<script>
let dictionary = [];
let currentWord = null;

/* ===== LOAD ===== */
fetch("dictionary-v2/dictionary.json")
  .then(r => r.json())
  .then(d => {
    dictionary = d.words;
    render();
  });

function render(){
  const list = document.getElementById("list");
  list.innerHTML = "";
  dictionary.forEach(w=>{
    const el = document.createElement("div");
    el.className = "word";
    el.innerHTML = `
      <h3>${w.ru}</h3>
      <small>${w.pos || ""}</small><br>
      ${w.senses.map(s=>`<div>${s.ing}</div>`).join("")}
      <div class="actions">
        <button class="btn" onclick="openEditor('${w.id}')">‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
      </div>
    `;
    list.appendChild(el);
  });
}

/* ===== EDITOR ===== */
function openEditor(id){
  currentWord = dictionary.find(w=>w.id===id);
  document.getElementById("ru").value = currentWord.ru;
  document.getElementById("pos").value = currentWord.pos || "";
  document.getElementById("ing").value = currentWord.senses.map(s=>s.ing).join("\n");
  renderExamples();
  document.getElementById("editor").classList.add("show");
}

function closeEditor(){
  document.getElementById("editor").classList.remove("show");
}

function renderExamples(){
  const box = document.getElementById("examples");
  box.innerHTML = "";
  currentWord.senses[0].examples.forEach(ex=>{
    const d = document.createElement("div");
    d.className = "example";
    d.innerHTML = `
      <textarea placeholder="ING">${ex.ing}</textarea>
      <textarea placeholder="RU">${ex.ru}</textarea>
    `;
    box.appendChild(d);
  });
}

function addExample(){
  currentWord.senses[0].examples.push({ing:"",ru:"",audio:null});
  renderExamples();
}

function saveWord(){
  currentWord.ru = document.getElementById("ru").value;
  currentWord.pos = document.getElementById("pos").value;
  currentWord.senses = document.getElementById("ing").value
    .split("\n")
    .filter(Boolean)
    .map(ing=>({
      ing,
      definition:null,
      examples: currentWord.senses[0].examples
    }));
  closeEditor();
  render();
}

/* ===== AI (–∑–∞–≥–ª—É—à–∫–∏) ===== */
function aiFixRu(){ alert("–ò–ò: —É–ª—É—á—à–∏—Ç—å —Ä—É—Å—Å–∫–∏–π"); }
function aiTranslateIng(){ alert("–ò–ò: –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∏–Ω–≥—É—à—Å–∫–∏–π"); }
function aiGenerateExample(){ alert("–ò–ò: –ø—Ä–∏–º–µ—Ä —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω"); }
</script>

</body>
</html>
